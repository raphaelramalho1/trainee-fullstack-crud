<nav class="navbar navbar-dark bg-primary">
  <div class="container">
    <span class="navbar-brand">Gerenciador de Tarefas</span>
    <a class="btn btn-light" routerLink="/tarefas/nova">➕ Nova Tarefa</a>
  </div>
</nav>

<div class="container mt-4">
  <div class="card">
    <div class="card-header">
      <h5 class="mb-1">Lista de Tarefas</h5>
      <small class="text-muted">
        Total: {{ taskService.totalTasks }} | 
        Pendentes: {{ taskService.pendingTasks.length }} | 
        Concluídas: {{ taskService.completedTasks.length }}
      </small>
    </div>

    <div class="card-body">
      <div class="btn-group mb-3 d-flex" role="group">
        <input type="radio" class="btn-check" name="filter" id="all" 
               [checked]="taskService.filter() === 'all'" (change)="onFilterChange('all')">
        <label class="btn btn-outline-primary" for="all">Todas ({{ taskService.totalTasks }})</label>
        
        <input type="radio" class="btn-check" name="filter" id="pending"
               [checked]="taskService.filter() === 'pending'" (change)="onFilterChange('pending')">
        <label class="btn btn-outline-info" for="pending">Pendentes ({{ taskService.pendingTasks.length }})</label>
        
        <input type="radio" class="btn-check" name="filter" id="completed"
               [checked]="taskService.filter() === 'completed'" (change)="onFilterChange('completed')">
        <label class="btn btn-outline-secondary" for="completed">Concluídas ({{ taskService.completedTasks.length }})</label>
      </div>

      @if (taskService.loading()) {
        <div class="text-center py-5">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Carregando...</span>
          </div>
          <p class="mt-2">Carregando tarefas...</p>
        </div>
      } @else {
        @if (taskService.filteredTasks().length === 0) {
          <div class="text-center py-5">
            @if (taskService.totalTasks === 0) {
              <h3>Comece criando sua primeira tarefa!</h3>
              <p class="text-muted">Organize suas atividades</p>
            } @else {
              <h3>Nenhuma tarefa {{ currentFilterLabel.toLowerCase() }}</h3>
              <p class="text-muted">Tente outro filtro</p>
            }
            <a class="btn btn-primary mt-2" routerLink="/tarefas/nova">
              {{ taskService.totalTasks === 0 ? 'Criar Primeira Tarefa' : 'Nova Tarefa' }}
            </a>
          </div>
        } @else {
          <div class="table-responsive">
            <table class="table table-hover">
              <thead class="table-dark">
                <tr>
                  <th scope="col">Status</th>
                  <th scope="col">Título</th>
                  <th scope="col">Descrição</th>
                  <th scope="col">Vencimento</th>
                  <th scope="col">Prioridade</th>
                  <th scope="col">Ações</th>
                </tr>
              </thead>
              <tbody>
                @for (task of taskService.filteredTasks(); track task.id) {
                  <tr [class.table-success]="task.completed">
                    <td>
                      <input 
                        class="form-check-input" 
                        type="checkbox" 
                        [checked]="task.completed"
                        [disabled]="isUpdating(task.id)"
                        (change)="toggleCompleted(task)">
                    </td>
                    <td [class.text-decoration-line-through]="task.completed" 
                        [class.text-muted]="task.completed">
                      {{ task.title }}
                    </td>
                    <td [class.text-decoration-line-through]="task.completed" 
                        [class.text-muted]="task.completed">
                      {{ task.description || '-' }}
                    </td>
                    <td>{{ formatDate(task.dueDate) }}</td>
                    <td>
                      <span class="badge" [class]="getPriority(task.priority).class">
                        {{ getPriority(task.priority).label }}
                      </span>
                    </td>
                    <td>
                      <a class="btn btn-sm btn-outline-primary me-1" 
                         [routerLink]="['/tarefas/editar', task.id]">Editar</a>
                      <button class="btn btn-sm btn-outline-danger" 
                              (click)="deleteTask(task)">Excluir</button>
                    </td>
                  </tr>
                }
              </tbody>
            </table>
          </div>
        }
      }
    </div>
  </div>
</div>
